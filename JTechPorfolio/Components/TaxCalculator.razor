@page "/tax"

<PageTitle>JTech Porfolio | Tax Calculator</PageTitle>

<EditForm class="row my-2 mx-2" Model="@newTax" OnValidSubmit="CalculateTax">
    <MudGrid>
        <MudItem>
            <MudNumericField T="decimal" HideSpinButtons="true" Culture="System.Globalization.CultureInfo.CurrentCulture"
            Immediate="false" Label="Input Amount" Format="N2" @bind-Value="newTax.InputAmount" Class="my-2"/>

            <MudNumericField T="decimal" HideSpinButtons="true" Culture="System.Globalization.CultureInfo.CurrentCulture"
                             Immediate="false" Label="Tax #1" Format="N2" @bind-Value="newTax.TaxOneAmount" Class="my-2" />

            <MudNumericField T="decimal" HideSpinButtons="true" Culture="System.Globalization.CultureInfo.CurrentCulture"
                             Immediate="false" Label="Tax #2" Format="N2" @bind-Value="newTax.TaxTwoAmount" Class="my-2"/>

            <MudNumericField T="decimal" HideSpinButtons="true" Culture="System.Globalization.CultureInfo.CurrentCulture"
                             Immediate="false" Label="Tax #3" Format="N2" @bind-Value="newTax.TaxThreeAmount" Class="my-2"/>

            <MudNumericField T="decimal" HideSpinButtons="true" Culture="System.Globalization.CultureInfo.CurrentCulture"
                             Immediate="false" Label="Tax #4" Format="N2" @bind-Value="newTax.TaxFourAmount" Class="my-2" />
        </MudItem>

        @* <MudItem>
            <MudButton Variant="Variant.Outlined" Color="Color.Primary">Calculate</MudButton>
        </MudItem> *@
    </MudGrid>
    @* <InputNumber class="form-control mx-2" style="width: 50%;" @bind-Value="newTax.InputAmount" placeholder="Input Amount" />
    
    <InputNumber class="form-control col m-2" @bind-Value="newTax.TaxOneAmount" placeholder="Tax #1" />
    <InputNumber class="form-control col m-2" @bind-Value="newTax.TaxTwoAmount" placeholder="Tax #2" />
    <InputNumber class="form-control col m-2" @bind-Value="newTax.TaxThreeAmount" placeholder="Tax #3" />
    <InputNumber class="form-control col m-2" @bind-Value="newTax.TaxFourAmount" placeholder="Tax #4" />

    <div>
        <button class="col-1 my-2 btn btn-outline-primary w-25" type="submit">Calculate</button>
    </div> *@
</EditForm>

<MudGrid class="m-2">
    <MudItem xs="1">
        <MudButton Variant="Variant.Outlined" OnClick="CalculateTax" Color="Color.Primary">Calculate</MudButton>
    </MudItem>
    <MudItem xs="1">
        <MudButton Variant="Variant.Outlined" OnClick="ClearValues" Color="Color.Error">Clear</MudButton>
    </MudItem>
</MudGrid>

<MudDivider />
@* <button onclick="@ClearValues" class="btn btn-outline-danger" type="submit">Clear</button> *@

@if (totalAmount > 0)
{
    <MudGrid Class="m-1">
        <MudItem>
            <MudText>Tax #1 Amount: $@taxOneAmount</MudText>
        </MudItem>

        <MudItem>
            <MudText>Tax #2 Amount: $@taxTwoAmount</MudText>
        </MudItem>

        <MudItem>
            <MudText>Tax #3 Amount: $@taxThreeAmount</MudText>
        </MudItem>

        <MudItem>
            <MudText>Tax #4 Amount: $@taxFourAmount</MudText>
        </MudItem>

        <MudDivider />

        <MudItem>
            <MudText Color="Color.Info" style="color: darkgreen;">Total: $@totalAmount</MudText>
        </MudItem>
    </MudGrid>
}

@code {
    TaxCalculatorModel newTax = new();
    decimal totalAmount = 0;

    decimal taxOneAmount = 0m;
    decimal taxTwoAmount = 0m;
    decimal taxThreeAmount = 0m;
    decimal taxFourAmount = 0m;

    private void CalculateTax()
    {
        if (newTax.InputAmount > 0)
        {
            if (newTax.TaxOneAmount > 0)
                taxOneAmount = Math.Round(newTax.InputAmount * (newTax.TaxOneAmount / 100), 2);

            if (newTax.TaxTwoAmount > 0)
                taxTwoAmount = Math.Round(newTax.InputAmount * (newTax.TaxTwoAmount / 100), 2);

            if (newTax.TaxThreeAmount > 0)
                taxThreeAmount = Math.Round(newTax.InputAmount * (newTax.TaxThreeAmount / 100),2);

            if (newTax.TaxFourAmount > 0)
                taxFourAmount = Math.Round(newTax.InputAmount * (newTax.TaxFourAmount / 100),2);

            totalAmount = newTax.InputAmount + taxOneAmount + taxTwoAmount + taxThreeAmount + taxFourAmount;
        }
    }

    private void ClearValues()
    {
        newTax = new();
        totalAmount = 0;
        taxOneAmount = 0m;
        taxTwoAmount = 0m;
        taxThreeAmount = 0m;
        taxFourAmount = 0m;
    }
}
